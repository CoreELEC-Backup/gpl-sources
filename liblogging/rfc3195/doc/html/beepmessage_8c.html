<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>liblogging: beepmessage.c File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>beepmessage.c File Reference</h1>Implementation of the BEEP Message Object.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;assert.h&gt;</code><br>
<code>#include "<a class="el" href="config_8h-source.html">config.h</a>"</code><br>
<code>#include "<a class="el" href="liblogging_8h-source.html">liblogging.h</a>"</code><br>
<code>#include "<a class="el" href="beepmessage_8h-source.html">beepmessage.h</a>"</code><br>
<code>#include "<a class="el" href="beepframe_8h-source.html">beepframe.h</a>"</code><br>
<table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a0" doxytag="beepmessage.c::sbMesgGetRawBuf"></a>
char *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a0">sbMesgGetRawBuf</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the raw buffer object <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a1" doxytag="beepmessage.c::sbMesgGetMIMEHdrSize"></a>
int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a1">sbMesgGetMIMEHdrSize</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the size of the MIME Header (in bytes) <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a2" doxytag="beepmessage.c::sbMesgGetPayloadSize"></a>
int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a2">sbMesgGetPayloadSize</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the size of the actual payload (in bytes) <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a3" doxytag="beepmessage.c::sbMesgGetOverallSize"></a>
int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a3">sbMesgGetOverallSize</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the overall message size (in bytes) <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsbMesgObject.html">sbMesgObj</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a4">sbMesgConstruct</a> (char *pszMIMEHdr, char *pszPayload)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor to create a Mesg based on provided values. </em> <a href="#a4"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="liblogging_8h.html#a6">srRetVal</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a5">sbMIMEExtract</a> (char *pszInBuf, int iInBufLen, char **pszMIMEHdr, char **pszPayload)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Extract MIME header and body from a given message buffer. </em> <a href="#a5"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="structsbMesgObject.html">sbMesgObj</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a6">sbMesgRecvMesg</a> (<a class="el" href="structsbChanObject.html">sbChanObj</a> *pChan)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Receive a message from a given channel. </em> <a href="#a6"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a7" doxytag="beepmessage.c::sbMesgConstrFromFrame"></a>
<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *&nbsp;</td><td class="memItemRight" valign=bottom><b>sbMesgConstrFromFrame</b> (<a class="el" href="structsbFramObject.html">sbFramObj</a> *psbFram)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="liblogging_8h.html#a6">srRetVal</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a8">sbMesgSendMesgWithCallback</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis, <a class="el" href="structsbChanObject.html">sbChanObj</a> *pChan, char *pszCmd, <a class="el" href="liblogging_8h.html#a9">SBansno</a> uAnsno, void(*OnFramDestroy)(<a class="el" href="structsbFramObject.html">sbFramObj</a> *), void *pUsr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a name="a9" doxytag="beepmessage.c::sbMesgSendMesg"></a>
<a class="el" href="liblogging_8h.html#a6">srRetVal</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a9">sbMesgSendMesg</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis, <a class="el" href="structsbChanObject.html">sbChanObj</a> *pChan, char *pszCmd, <a class="el" href="liblogging_8h.html#a9">SBansno</a> uAnsno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The same as <a class="el" href="beepmessage_8h.html#a11">sbMesgSendMesgWithCallback</a>, except that no callback is provided. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="beepmessage_8c.html#a10">sbMesgDestroy</a> (<a class="el" href="structsbMesgObject.html">sbMesgObj</a> *pThis)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor. </em> <a href="#a10"></a><em><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implementation of the BEEP Message Object. 
<p>
<dl compact><dt><b>Author:</b></dt><dd>Rainer Gerhards &lt;<a href="mailto:rgerhards@adiscon.com">rgerhards@adiscon.com</a>&gt; </dd></dl>
<dl compact><dt><b>Date:</b></dt><dd>2003-08-04</dd></dl>
Copyright 2002-2003 Rainer Gerhards and Adiscon GmbH. All Rights Reserved.<p>
Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:<p>
* Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.<p>
* Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.<p>
* Neither the name of Adiscon GmbH or Rainer Gerhards nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.<p>
THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.<hr><h2>Function Documentation</h2>
<a name="a4" doxytag="beepmessage.c::sbMesgConstruct"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsbMesgObject.html">sbMesgObj</a>* sbMesgConstruct </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pszMIMEHdr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pszPayload</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructor to create a Mesg based on provided values. 
<p>
with no MIME headers.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>szMIMEHdr</em>&nbsp;</td><td>[in] buffer to MIME headers. Is copied to private buffer space. May be NULL, in which case no MIME headers are present. </td></tr>
    <tr><td valign=top><em>szPayload</em>&nbsp;</td><td>[in] buffer to payload data. Is copied to private buffer. May be NULL, in which case an empty payload is created after the MIME header.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Pointer</em>&nbsp;</td><td>to new message object or NULL if an error occured. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a10" doxytag="beepmessage.c::sbMesgDestroy"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void sbMesgDestroy </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsbMesgObject.html">sbMesgObj</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pThis</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destructor. 
<p>
Does not return any value as the primary function to be used is free() which itself does not return any status.     </td>
  </tr>
</table>
<a name="a6" doxytag="beepmessage.c::sbMesgRecvMesg"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="structsbMesgObject.html">sbMesgObj</a>* sbMesgRecvMesg </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsbChanObject.html">sbChanObj</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Receive a message from a given channel. 
<p>
As we do not currently support fragmentation, this method simply reads a single fram off the socket and uses that frame to construct the message.<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Pointer</em>&nbsp;</td><td>to newly constructed MesgObj or NULL if an error occured. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a8" doxytag="beepmessage.c::sbMesgSendMesgWithCallback"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="liblogging_8h.html#a6">srRetVal</a> sbMesgSendMesgWithCallback </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="structsbMesgObject.html">sbMesgObj</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pThis</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="structsbChanObject.html">sbChanObj</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pChan</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pszCmd</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="liblogging_8h.html#a9">SBansno</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>uAnsno</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void(*&nbsp;</td>
          <td class="mdname" nowrap> <em>OnFramDestroy</em>)(<a class="el" href="structsbFramObject.html">sbFramObj</a> *), </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>void *&nbsp;</td>
          <td class="mdname" nowrap> <em>pUsr</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
For now, we assume a Mesg will always fit into one Fram. This is always true for syslog. So there is no need to do it more complicated. In the long term, it may be worth changing this...    </td>
  </tr>
</table>
<a name="a5" doxytag="beepmessage.c::sbMIMEExtract"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="liblogging_8h.html#a6">srRetVal</a> sbMIMEExtract </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">char *&nbsp;</td>
          <td class="mdname" nowrap> <em>pszInBuf</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iInBufLen</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>pszMIMEHdr</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>char **&nbsp;</td>
          <td class="mdname" nowrap> <em>pszPayload</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Extract MIME header and body from a given message buffer. 
<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000009">Todo:</a></b></dt><dd>handle empty string</dd></dl>
    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Mon Oct 3 12:29:55 2005 for liblogging by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
